<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Video Steganography (LSB + AES)</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
  <style>
    .btn {
      display: inline-block;
      background: #28a745;
      color: white;
      padding: 12px 24px;
      margin: 10px 0;
      border-radius: 8px;
      text-decoration: none;
      font-weight: bold;
      transition: 0.3s;
    }
    .btn:hover { background: #218838; }
    .btn-download { background: #007bff; }
    .btn-download:hover { background: #0056b3; }
    .flash { background: #d4edda; color: #155724; padding: 12px; border-radius: 8px; margin: 15px 0; }
    .error { background: #f8d7da; color: #721c24; }
    .decoded-box { background: #1e1e1e; color: #0f0; padding: 15px; border-radius: 8px; margin: 20px 0; font-family: monospace; }
    .stats-card { background: #f0f8ff; color: #000; padding: 15px; border-radius: 10px; margin: 15px 0; text-align: left; }
  </style>
</head>
<body>
  <div class="container">
    <h1>Video Steganography</h1>
    <p>Hide and reveal secret messages inside videos using <strong>LSB + AES</strong>.</p>

    <!-- Flash Messages -->
    {% with messages = get_flashed_messages() %}
      {% if messages %}
        <div class="flash {% if 'Error' in messages[0] %}error{% endif %}">
          {% for msg in messages %}
            <p>{{ msg }}</p>
          {% endfor %}
        </div>
      {% endif %}
    {% endwith %}

    <!-- âœ… Video Details -->
    {% if frame_count %}
    <div class="stats-card">
      <h3>ðŸ“Š Video Details</h3>
      <ul>
        <li><strong>Frame Count:</strong> {{ frame_count }}</li>
        <li><strong>Resolution:</strong> {{ resolution }}</li>
        <li><strong>Total Capacity:</strong> {{ total_capacity }}</li>
        <li><strong>Used Space:</strong> {{ used }}</li>
        <li><strong>Remaining Space:</strong> {{ remaining }}</li>
        <li><strong>Max Embeddable Characters:</strong> {{ max_chars }}</li>
        <li><strong>Remaining Characters:</strong> {{ remaining_chars }}</li>
      </ul>
    </div>
    {% endif %}

    <!-- Download Link -->
    {% if download_link %}
    <div class="download-links">
      <h3>Download Encoded Video</h3>
      <p><strong>Saved as:</strong> <code>{{ stego_filename }}</code></p>
      <a href="{{ url_for('download_file', filename=download_link.split('/')[-1]) }}" 
         class="btn btn-download" download>
        Download {{ stego_filename }}
      </a>
    </div>
    {% endif %}

    <!-- Encode Form -->
    <div class="form-section">
      <h2>Encode Message</h2>
      <form action="/encode" method="post" enctype="multipart/form-data">
        <input type="file" name="video" accept="video/*" required><br><br>
        <textarea name="message" placeholder="Enter your secret message..." rows="4" required></textarea><br><br>
        <input type="password" name="password" placeholder="Enter password" required><br><br>
        <button type="submit" class="btn">Encode & Download</button>
      </form>
    </div>

    <hr>

    <!-- Decode Form -->
    <div class="form-section">
      <h2>Decode Message</h2>
      <form action="/decode" method="post" enctype="multipart/form-data">
        <input type="file" name="video" accept=".avi,.mkv" required><br><br>
        <input type="password" name="password" placeholder="Enter password" required><br><br>
        <button type="submit" class="btn">Decode Message</button>
      </form>
    </div>

    <!-- Decoded Message -->
    {% if decoded_message %}
      <div class="decoded-box">
        <h3>Decoded Message:</h3>
        <p>{{ decoded_message }}</p>
      </div>
    {% endif %}
  </div>
</body>
</html>